CMAKE_MINIMUM_REQUIRED(VERSION 3.6)

INCLUDE(ExternalProject)

IF(${CMAKE_CXX_COMPILER} STREQUAL "/usr/bin/clang++")
  SET(CMAKE_CXX_FLAGS_YCPP "-stdlib=libc++")
ENDIF()

IF(${CMAKE_CXX_COMPILER} STREQUAL "/usr/bin/g++")
  SET(CMAKE_CXX_FLAGS_YCPP "")
ENDIF()

EXTERNALPROJECT_ADD(yamlcpp
    URL "https://github.com/jbeder/yaml-cpp/archive/yaml-cpp-0.6.2.tar.gz"
    PREFIX ${CMAKE_CURRENT_BINARY_DIR}
    BUILD_IN_SOURCE 1
    INSTALL_DIR "${CMAKE_BINARY_DIR}/"
    CMAKE_ARGS -DBUILD_SHARED_LIBS=ON -DYAML_CPP_BUILD_TESTS=OFF -DYAML_CPP_BUILD_TOOLS=OFF -DCMAKE_CXX_COMPILER=${CMAKE_CXX_COMPILER} -DCMAKE_CXX_FLAGS=${CMAKE_CXX_FLAGS_YCPP}
    BUILD_COMMAND make
    INSTALL_COMMAND ""
)

SET(YAMLCPP_INCLUDE_DIRS ${CMAKE_CURRENT_BINARY_DIR}/src/yamlcpp/include PARENT_SCOPE)
SET(YAMLCPP_LINK_DIRS ${CMAKE_CURRENT_BINARY_DIR}/src/yamlcpp PARENT_SCOPE)
